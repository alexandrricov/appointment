<link rel="import" href="addresses.html">
<link rel="import" href="services.html">
<link rel="import" href="calendar.html">
<link rel="import" href="specialists.html">
<link rel="import" href="form.html">

<template id="le-appointment">
  <style>
    #appointment {
      box-sizing: border-box;
      height: 100%;
    }

    h1 {
      background-color: green;
      margin: 0;
      text-align: center;
      color: #fff;
      padding: 10px 0;
    }
  </style>
  <section id="appointment">
    <h1>Appointment</h1>
  </section>
</template>

<script>
  class Appointment extends HTMLElement {
    constructor() {
      super();

      const ownerDocument = (document._currentScript || document.currentScript).ownerDocument;
      const shadowRoot = this.attachShadow({mode: 'closed'});
      shadowRoot.appendChild(document.importNode(ownerDocument.querySelector('#le-appointment').content, true));

      this._appointment = shadowRoot.querySelector('#appointment');

      this.initAddresses();
    }

    initAddresses() {
      const node = document.createElement('appointment-addresses');
      node.goForward = (e) => {
        console.log(e);

        this._appointment.removeChild(node);
        this.initServices();
      };

      this._appointment.appendChild(node);
    }

    initServices() {
      const node = document.createElement('appointment-services');
      node.goBack = () => {
        this._appointment.removeChild(node);
        this.initAddresses();
      };

      node.goForward = (e) => {
        console.log(e);
        this._appointment.removeChild(node);
        this.initCalendar();
      };

      this._appointment.appendChild(node);
    }

    initCalendar() {
      const node = document.createElement('appointment-calendar');
      node.goBack = () => {
        this._appointment.removeChild(node);
        this.initServices();
      };

      node.goForward = (e) => {
        console.log(e);
        this._appointment.removeChild(node);
        this.initSpecialists();
      };

      this._appointment.appendChild(node);
    }

    initSpecialists() {
      const node = document.createElement('appointment-specialists');
      node.goBack = () => {
        this._appointment.removeChild(node);
        this.initCalendar();
      };

      node.goForward = (e) => {
        console.log(e);
        this._appointment.removeChild(node);
        this.initForm();
      };

      this._appointment.appendChild(node);
    }

    initForm() {
      const node = document.createElement('appointment-form');
      node.goBack = () => {
        this._appointment.removeChild(node);
        this.initSpecialists();
      };

      node.goForward = (e) => {
        alert(JSON.stringify(e));
      };

      this._appointment.appendChild(node);
    }
  }

  customElements.define('x-appointment', Appointment);
//    document.registerElement('x-appointment', Appointment);
</script>
